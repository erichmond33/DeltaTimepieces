{% extends "website/layout.html" %}
{% load static %}

{% block body-class %}
bg-grey
{% endblock %}

{% block body %}
    

    <div class="container-fluid pt-5">
        <div class="container mw-lg">
            <div class="row g-5">
    
                <div class="col-md-5 col-12 order-md-last">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"
                                    aria-expanded="true" aria-controls="collapseOne">
                                    <div class="d-flex flex-column">
                                        <div class="d-flex justify-content-start align-items-center">
                                            <span class="fs-4 me-2">Your cart</span>
                                            <span class="badge bg-primary rounded-pill fs-6">{{ cart|length }}</span>
                                        </div>
                                        <span class="fs-6 text-muted">${{ total }}</span>
                                    </div>
                                </button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    {% for watch in cart %}
                                    <div class="row py-3 border-bottom">
                                        <div class="col-5 px-md-0 px-sm-5 px-3">
                                            <img src="{{ watch.image.url }}" class="img-fluid rounded square-img" alt="Image">
                                        </div>
                                        <div class="col-7">
                                            <div class="d-flex flex-column h-100">
                                                <h6 class="my-0 text-muted">{{ watch.name }}</h6>
                                                <h6 class="fw-bolder fst-italic">${{ watch.price }}</h6>
                                                <div class="d-flex justify-content-end align-items-end flex-grow-1">
                                                    <form action="{% url 'remove_from_cart' watch.id %}" method="post" class="m-0">
                                                        {% csrf_token %}
                                                        <button class="btn btn-danger btn-sm py-0" type="submit">Remove</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% empty %}
                                    <div class="row py-3 border-bottom">
                                        <div class="col-12">
                                            <p class="text-muted">Your cart is empty</p>
                                        </div>
                                    </div>
                                    {% endfor %}
                                    <div class="row pt-3">
                                        <div class="col-12">
                                            <h5 class="my-0">Total</h5>
                                            <span class="text-body-secondary">${{ total }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    
                <div class="col-md-7 col-12">
                    {% include 'website/checkout_form.html' %}
                </div>
            </div>
        </div>
</div>

{% endblock %}